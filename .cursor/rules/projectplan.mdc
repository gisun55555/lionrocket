---
alwaysApply: false
---
## ğŸ› ï¸ ê¸°ìˆ  ìŠ¤íƒ

### Frontend
- **Framework**: Next.js 14 (App Router)
- **Language**: TypeScript
- **Styling**: Tailwind CSS
- **State Management**: Zustand
- **Form**: React Hook Form + Zod
- **Icons**: Lucide React
- **HTTP Client**: Fetch API

### Backend
- **Runtime**: Node.js
- **Framework**: Express + TypeScript
- **Database**: SQLite + Prisma ORM
- **Authentication**: JWT
- **File Upload**: Multer
- **AI API**: Claude API (Anthropic)
- **Security**: Helmet, CORS, bcrypt

### Development Tools
- **Package Manager**: npm
- **Linting**: ESLint + Prettier
- **Type Checking**: TypeScript

---

## ğŸ¯ í•µì‹¬ ê¸°ëŠ¥ ëª…ì„¸

### 1. ì¸ì¦ ì‹œìŠ¤í…œ
- **ë°©ì‹**: ì´ë©”ì¼ + ë¹„ë°€ë²ˆí˜¸
- **í† í°**: JWT (Access Token)
- **ë§Œë£Œì‹œê°„**: 1ì‹œê°„
- **ì €ì¥ë°©ì‹**: ë©”ëª¨ë¦¬ ìš°ì„  (ì„ íƒì  localStorage)
- **ë³´ì•ˆ**: bcrypt í•´ì‹±, Helmet + CSP

### 2. AI ìºë¦­í„° ê´€ë¦¬
- **ê¸°ë³¸ ìºë¦­í„°**: 3ê°œ ì œê³µ (ì¹œê·¼í•œ ì–´ì‹œìŠ¤í„´íŠ¸, ì°½ì˜ì  ì‘ê°€, ê¸°ìˆ  ì „ë¬¸ê°€)
- **ì»¤ìŠ¤í…€ ìºë¦­í„°**: ì‚¬ìš©ì ìƒì„± ê°€ëŠ¥
  - ì´ë¦„ ì„¤ì •
  - í”„ë¡¬í”„íŠ¸ ì •ì˜ 
  - ì¸ë„¤ì¼ ì´ë¯¸ì§€ ì—…ë¡œë“œ
- **ì´ë¯¸ì§€ ì²˜ë¦¬**: PNG/JPEG/WEBP/AVIF, 5MB ì œí•œ
- **ì €ì¥ê²½ë¡œ**: `uploads/YYYY/MM/hash.ext`

### 3. ì±„íŒ… ê¸°ëŠ¥
- **ë©”ì‹œì§€ ì œí•œ**: 200ì ì´ë‚´
- **AI API**: Claude API ì—°ë™
- **ì‹¤ì‹œê°„ì„±**: ë¡œë”© ìƒíƒœ í‘œì‹œ
- **ëŒ€í™” ê´€ë¦¬**: ìºë¦­í„°ë³„ ë…ë¦½ì  ê´€ë¦¬
- **ë°ì´í„° ì˜ì†ì„±**: ë¸Œë¼ìš°ì € ìƒˆë¡œê³ ì¹¨ í›„ ë³µì›

### 4. ë°ì´í„° ëª¨ë¸
```sql
User (ì‚¬ìš©ì)
â”œâ”€â”€ id: String (PK)
â”œâ”€â”€ email: String (unique)
â”œâ”€â”€ password: String (hashed)
â”œâ”€â”€ name: String
â””â”€â”€ timestamps

Character (ìºë¦­í„°)
â”œâ”€â”€ id: String (PK)
â”œâ”€â”€ name: String
â”œâ”€â”€ prompt: String
â”œâ”€â”€ thumbnail: String? (ì´ë¯¸ì§€ URL)
â”œâ”€â”€ isDefault: Boolean
â”œâ”€â”€ userId: String? (FK)
â””â”€â”€ timestamps

Message (ë©”ì‹œì§€)
â”œâ”€â”€ id: String (PK)
â”œâ”€â”€ content: String
â”œâ”€â”€ isUser: Boolean
â”œâ”€â”€ userId: String (FK)
â”œâ”€â”€ characterId: String (FK)
â””â”€â”€ timestamp
```

---

## ğŸš€ ê°œë°œ ë‹¨ê³„ë³„ ê³„íš

### Phase 1: í”„ë¡œì íŠ¸ ì„¤ì •
- [ ] í´ë” êµ¬ì¡° ìƒì„±
- [ ] í”„ë¡ íŠ¸ì—”ë“œ Next.js ì„¤ì •
- [ ] ë°±ì—”ë“œ Express + TypeScript ì„¤ì •
- [ ] ë°ì´í„°ë² ì´ìŠ¤ Prisma ì„¤ì •
- [ ] í™˜ê²½ë³€ìˆ˜ ë° Git ì„¤ì •

### Phase 2: ë°±ì—”ë“œ API ê°œë°œ
- [ ] ë°ì´í„°ë² ì´ìŠ¤ ìŠ¤í‚¤ë§ˆ ì •ì˜
- [ ] ì¸ì¦ API (íšŒì›ê°€ì…, ë¡œê·¸ì¸)
- [ ] ìºë¦­í„° CRUD API
- [ ] ë©”ì‹œì§€ ê´€ë¦¬ API
- [ ] ì´ë¯¸ì§€ ì—…ë¡œë“œ API
- [ ] Claude API ì—°ë™

### Phase 3: í”„ë¡ íŠ¸ì—”ë“œ UI ê°œë°œ 
- [ ] ë¡œê·¸ì¸/íšŒì›ê°€ì… í˜ì´ì§€
- [ ] ìºë¦­í„° ì„ íƒ í˜ì´ì§€
- [ ] ì±„íŒ… ì¸í„°í˜ì´ìŠ¤
- [ ] ìºë¦­í„° ìƒì„±/í¸ì§‘ ëª¨ë‹¬
- [ ] ìƒíƒœ ê´€ë¦¬ êµ¬í˜„

### Phase 4: í†µí•© ë° ìµœì í™”
- [ ] í”„ë¡ íŠ¸ì—”ë“œ-ë°±ì—”ë“œ ì—°ë™
- [ ] ì—ëŸ¬ ì²˜ë¦¬ ë° ê²€ì¦
- [ ] ë¡œë”© ìƒíƒœ ê´€ë¦¬
- [ ] ë°˜ì‘í˜• ë””ìì¸
- [ ] ì„±ëŠ¥ ìµœì í™”

---

## ğŸ“ API ì„¤ê³„

### Authentication
- `POST /api/auth/register` - íšŒì›ê°€ì…
- `POST /api/auth/login` - ë¡œê·¸ì¸
- `POST /api/auth/logout` - ë¡œê·¸ì•„ì›ƒ
- `GET /api/auth/me` - ì‚¬ìš©ì ì •ë³´ ì¡°íšŒ

### Characters
- `GET /api/characters` - ìºë¦­í„° ëª©ë¡ ì¡°íšŒ
- `POST /api/characters` - ìºë¦­í„° ìƒì„±
- `PUT /api/characters/:id` - ìºë¦­í„° ìˆ˜ì •
- `DELETE /api/characters/:id` - ìºë¦­í„° ì‚­ì œ
- `POST /api/characters/upload` - ì¸ë„¤ì¼ ì—…ë¡œë“œ

### Messages
- `GET /api/messages/:characterId` - ìºë¦­í„°ë³„ ë©”ì‹œì§€ ì¡°íšŒ
- `POST /api/messages/:characterId` - ë©”ì‹œì§€ ì „ì†¡ (AI ì‘ë‹µ í¬í•¨)

---

## ğŸ”’ ë³´ì•ˆ ê³ ë ¤ì‚¬í•­

1. **ì…ë ¥ ê²€ì¦**: Zod ìŠ¤í‚¤ë§ˆë¡œ ëª¨ë“  ì…ë ¥ ë°ì´í„° ê²€ì¦
2. **íŒŒì¼ ì—…ë¡œë“œ**: íŒŒì¼ íƒ€ì…, í¬ê¸°, ë§¤ì§ë„˜ë²„ ê²€ì¦
3. **ì¸ì¦**: JWT í† í° ë§Œë£Œ ì²˜ë¦¬, ë¯¼ê°í•œ API ë³´í˜¸
4. **XSS ë°©ì§€**: CSP í—¤ë”, HTML ì´ìŠ¤ì¼€ì´í•‘
5. **SQL ì¸ì ì…˜**: Prisma ORM ì‚¬ìš©ìœ¼ë¡œ ë°©ì§€
6. **CORS**: í”„ë¡ íŠ¸ì—”ë“œ ë„ë©”ì¸ë§Œ í—ˆìš©

---

## ğŸ“Š ì„±ëŠ¥ ìµœì í™” ë°©ì•ˆ

1. **ì´ë¯¸ì§€**: WebP ë³€í™˜, ìºì‹œ í—¤ë” ì„¤ì •
2. **API**: ì‘ë‹µ ìºì‹±, í˜ì´ì§€ë„¤ì´ì…˜
3. **í”„ë¡ íŠ¸ì—”ë“œ**: ì½”ë“œ ìŠ¤í”Œë¦¬íŒ…, ì´ë¯¸ì§€ ìµœì í™”
4. **ë°ì´í„°ë² ì´ìŠ¤**: ì¸ë±ìŠ¤ ì„¤ì •, ì¿¼ë¦¬ ìµœì í™”

---




